$(function() {    $('a[href="#"]').click(function(e){ e.preventDefault(); });    /*! http://johnpolacek.github.io/imagefill.js/ */    // $('.item').imagefill();    /*! http://www.jacklmoore.com/autosize/ */    autosize($('textarea'));    /*! https://select2.github.io/ */    $('select').select2({      minimumResultsForSearch: Infinity    });    /*! Inputs mask*/    function inputMask() {      $(".mask-date").mask("99.99.9999",{placeholder:"__.__.____"});      $(".mask-year").mask("9999",{placeholder:""});      $(".mask-tel").mask("+79999999999",{placeholder:""});    };    inputMask();    $('.carousel-preview').slick({      slidesToShow: 1,      slidesToScroll: 1,      arrows: true,      fade: true,      asNavFor: '.carousel-thumbs'    });    $('.carousel-thumbs').slick({      slidesToShow: 3,      slidesToScroll: 1,      asNavFor: '.carousel-preview',      dots: false,      focusOnSelect: true,      arrows: false,      mobileFirst: true,      responsive: [        {          breakpoint: 480,          settings: {            slidesToShow: 5          }        },        {          breakpoint: 700,          settings: {            slidesToShow: 7          }        },        {          breakpoint: 991,          settings: {            slidesToShow: 8          }        }      ]    });
    $('.m_docs .item').each(function() {        $(this).magnificPopup({            delegate: 'a',            type: 'image',            gallery: {              enabled:true            }        });    });
    function mobileMenu() {      $('.mobile-menu-trigger').on('click', function(){        $(this).toggleClass('open');        $('.m_header .bottom .nav').toggleClass('open');      });    }    mobileMenu();    function headerSearch() {      var $input = $('#js-headerSearch');      var $trigger = $('.search-trigger');      $trigger.on('click', function(){        $(this).parent().addClass('open');        $input.focus();      });      $(document).mouseup(function (e) {        var container = $('.m_header .search');        if (!container.is(e.target) && container.has(e.target).length === 0) {          $('.m_header .search').removeClass('open');        }      });    }    headerSearch();
    console.log('Layout generated');
    function leadCarousel() {      $('.m_lead-carousel').slick({        dots: true,        arrows: false,        mobileFirst: true,        infinite: false,        speed: 600,        responsive: [          {            breakpoint: 1400,            settings: {              dots: false,              arrows: true            }          }        ]      })    }    leadCarousel();
    /*!      News Carousel    */    function newsCarouselVariables() {      viewportWidth = $(window).width();      $newsCarousel = $(".news-carousel");      if( viewportWidth <= 390 ){          newsRows = 2;          newsSlides = 1;          $(".news-carousel").removeClass('doubled');      } else if( viewportWidth > 390 && viewportWidth <= 568 ){          newsRows = 2;          newsSlides = 2;          $(".news-carousel").addClass('doubled');      } else if( viewportWidth > 568 &&  viewportWidth < 960){          newsRows = 1;          newsSlides = 3;          $(".news-carousel").removeClass('doubled');      } else if( viewportWidth >= 960 ) {        newsRows = 1;        newsSlides = 4;        $(".news-carousel").removeClass('doubled');      }    }    function newsCarousel() {      newsCarouselVariables();      $newsCarousel.slick({          dots: false,          arrows: true,          infinite: false,          slidesToShow: newsSlides,          slidesToScroll: newsSlides,          rows: newsRows      });    }    newsCarousel();    function newsCarouselReinitial() {      newsCarouselVariables();      $newsCarousel.slick('unslick');      console.log('unslick');      $newsCarousel.slick({          dots: false,          arrows: true,          infinite: false,          slidesToShow: newsSlides,          slidesToScroll: newsSlides,          rows: newsRows      });    }    $(window).on('resize', function(){      newsCarouselReinitial();    });    /*!      end News Carousel    */
    function popupForm() {      $('.popup-button').magnificPopup({        type: 'inline',        fixedContentPos: false,        fixedBgPos: true,        overflowY: 'auto',        closeBtnInside: true,        preloader: false,        midClick: true,        removalDelay: 300,        mainClass: 'my-mfp-zoom-in'      });      $('.popup form').on('submit', function(){        $.magnificPopup.close();        setTimeout(function(){          $.magnificPopup.open({                  items: {                      src: '#popup-ty'                  },                  type: 'inline',                  fixedContentPos: false,                  fixedBgPos: true,                  overflowY: 'auto',                  closeBtnInside: true,                  preloader: false,                  midClick: true,                  removalDelay: 300,                  mainClass: 'my-mfp-zoom-in'          });        }, 350);        return false;      });      $('.form-row input[type=file]').on('change', function(){        if ( !$(this).val() == '' ) {          var filename = $(this).val().replace(/C:\\fakepath\\/i, '');          $(this).parent().hide();          $(this).parent().next().find('.value').text('Файл добавлен: '+filename);          $(this).parent().next().show();        }      });      $('.attach-result .remove').on('click', function(){        $(this).text('');        $(this).parent().hide();        $(this).parent().prev().show();        $(this).parent().prev().find('input[type=file]').val('');      });    }    popupForm();});